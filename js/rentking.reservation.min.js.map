{"version":3,"sources":["rentking.reservation.js"],"names":["$","$paymentDescription","$paymentAmount","$coupon","$reservationForm","$paymentForm","$totalPrice","document","on","e","stopPropagation","trigger","target","parseInt","data","coupon","couponPercent","indexOf","couponDiscountAmount","parseFloat","Math","floor","promotion","promotionPercent","promotionDiscountAmount","val","this","find","removeClass","$buymethod","addClass","$carImage","$positionRentshop","$positionPickup","$positionReturn","$delCharge","delcharge","attr","hide","show","amount","$form","preventDefault","$agreeCancel","$agreeTransaction","$agree","$ptype","buyMethod","payType","length","filter","alert","focus","nums","date1","date2","checked","action","confirm","post","serializeArray","done","html"],"mappings":"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","file":"rentking.reservation.min.js","sourcesContent":["$(function() {\r\n\tvar $paymentDescription = $('#paymentDescription');\r\n\tvar $paymentAmount = $('#paymentAmount');\r\n\tvar $coupon = $('#coupon');\r\n\tvar $reservationForm = $('#reservationForm');\r\n\tvar $paymentForm = $('#paymentForm');\r\n\tvar $totalPrice = $('#totalPrice');\r\n\r\n\t$(document)\r\n\t\t.on('calc', '#paymentAmount', function(e) {\r\n\t\t\te.stopPropagation();\r\n\r\n\t\t\t$totalPrice.trigger('animate');\r\n\r\n\t\t\tvar target = parseInt($paymentAmount.data('amount')) + parseInt($paymentAmount.data('delcharge'));\r\n\r\n\t\t\tvar coupon = $paymentAmount.data('coupon');\r\n\t\t\tif(typeof coupon !== 'undefined' && coupon != 0) {\r\n\t\t\t\tvar couponPercent = false;\r\n\r\n\t\t\t\tif(('' + coupon).indexOf('%') > -1) {\r\n\t\t\t\t\tcouponPercent = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar couponDiscountAmount = parseFloat(coupon);\r\n\r\n\t\t\t\tif(couponPercent) {\r\n\t\t\t\t\tcouponDiscountAmount = Math.floor(target * couponDiscountAmount / 10000) * 100;\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttarget -= couponDiscountAmount;\r\n\t\t\t}\r\n\r\n\r\n\t\t\tvar promotion = $paymentAmount.data('promotion');\r\n\t\t\tif(typeof promotion !== 'undefined' && promotion != 0) {\r\n\t\t\t\tvar promotionPercent = false;\r\n\r\n\t\t\t\tif(('' + promotion).indexOf('%') > -1) {\r\n\t\t\t\t\tpromotionPercent = true;\r\n\t\t\t\t}\r\n\t\t\t\tvar promotionDiscountAmount = parseFloat(promotion);\r\n\r\n\t\t\t\tif(promotionPercent) {\r\n\t\t\t\t\tpromotionDiscountAmount = Math.floor(target * promotionDiscountAmount / 10000) * 100;\r\n\t\t\t\t}\r\n\t\t\t\ttarget -= promotionDiscountAmount;\r\n\r\n\t\t\t\t$('#discount').data('target', promotionDiscountAmount).trigger('animate');\r\n\t\t\t}\r\n\r\n\t\t\tif(target < 0) {\r\n\t\t\t\t//TODO: alert 띄울지 운영팀과 협의\r\n\t\t\t\t//alert('쿠폰 차감금액이 결제금액을 초과합니다.\\n초과되는 금액은 예약과 동시에 쿠폰과 함께 소멸됩니다.');\r\n\t\t\t}\r\n\r\n\t\t\t$paymentAmount.data('target', target < 0 ? 0 : target).trigger('animate');\r\n\t\t})\r\n\t\t.on('change', 'input[name=\"payType\"]', function(e) {\r\n\t\t\tvar val = $(this).val();\r\n\r\n\t\t\t$paymentDescription.find('span').removeClass('text-point');\r\n\t\t\tvar $buymethod = $('#buymethod');\r\n\t\t\tif(val == 1) {\t//전액 결제\r\n\t\t\t\t$paymentAmount.data('amount', parseInt($paymentAmount.data('all')));\r\n\t\t\t\t$paymentDescription.find('span.all').addClass('text-point');\r\n\t\t\t\t$buymethod.val('C');\r\n\t\t\t} else {\t\t//월별 결제\r\n\t\t\t\t$paymentAmount.data('amount', parseInt($paymentAmount.data('month')));\r\n\t\t\t\t$paymentDescription.find('span.month').addClass('text-point');\r\n\t\t\t\t$buymethod.val('F');\r\n\t\t\t}\r\n\t\t\t$paymentAmount.trigger('calc');\r\n\t\t})\r\n\t\t.on('change', 'input[name=\"ptype\"]', function(e) {\r\n\t\t\tvar val = $(this).val();\r\n\r\n\t\t\tvar $carImage = $('#carImage');\r\n\t\t\tvar $positionRentshop = $('#positionRentshop');\r\n\t\t\tvar $positionPickup = $('#positionPickup');\r\n\t\t\tvar $positionReturn = $('#positionReturn');\r\n\t\t\tvar $delCharge = $('#delCharge');\r\n\t\t\tvar delcharge = parseInt($('input[name=\"delcharge\"]').val());\r\n\r\n\t\t\tif(val == 1) {\r\n\t\t\t\t$carImage.attr('rowspan', 5);\r\n\t\t\t\t$positionRentshop.hide();\r\n\t\t\t\t$positionPickup.show();\r\n\t\t\t\t$positionReturn.show();\r\n\r\n\t\t\t\t$delCharge.show();\r\n\r\n\t\t\t\t$totalPrice.data('target', parseInt($totalPrice.data('totalAccount')) + delcharge);\r\n\r\n\t\t\t\t$paymentAmount.data('delcharge', delcharge).trigger('calc');\r\n\r\n\t\t\t} else {\r\n\t\t\t\t$carImage.attr('rowspan', 4);\r\n\t\t\t\t$positionRentshop.show();\r\n\t\t\t\t$positionPickup.hide();\r\n\t\t\t\t$positionReturn.hide();\r\n\r\n\t\t\t\t$delCharge.hide();\r\n\r\n\t\t\t\t$totalPrice.data('target', parseInt($totalPrice.data('totalAccount')));\r\n\r\n\t\t\t\t$paymentAmount.data('delcharge', 0).trigger('calc');\r\n\t\t\t}\r\n\t\t})\r\n\t\t.on('change', '#coupon', function(e) {\r\n\t\t\tvar amount = $coupon.find('option:selected').data('account');\r\n\t\t\t$paymentAmount.data('coupon', amount).trigger('calc');\r\n\t\t})\r\n\t\t.on('submit', '#reservationForm', function(e) {\r\n\t\t\tvar $form = $(this);\r\n\r\n\t\t\tif(!$form.data('payment')) {\r\n\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\tvar $agreeCancel = $('#agreeCancel');\r\n\t\t\t\tvar $agreeTransaction = $('#agreeTransaction');\r\n\t\t\t\tvar $agree = null;\r\n\t\t\t\tvar $ptype = $('input[name=\"ptype\"]');\r\n\t\t\t\tvar buyMethod = $('#buymethod').val();\r\n\t\t\t\tvar payType = $(\"input[name=payType]\").val();\r\n\r\n\t\t\t\tif($ptype.length > 1){\r\n\r\n\t\t\t\t\tif($ptype.filter(':checked').length < 1) {\r\n                        alert('대여방법을 선택해주세요');\r\n                        $($ptype[0]).focus();\r\n                        return false;\r\n                    }\r\n\r\n                    if($(\"input[name=ptype]:checked\").val() == 1) {\r\n                        var nums = $('input[name=nums]').val();\r\n                        var date1 = $('input[name=date1]').val();\r\n                        var date2 = $('input[name=date2]').val();\r\n\r\n                        if(nums == '' || date1 == '' || date2 == ''){\r\n                            alert('대여방법이 \"배달대여\"일 경우 제1운전자 면허정보는 필수 입력사항 입니다.');\r\n                            return false;\r\n\t\t\t\t\t\t}else if(nums.length < 10){\r\n                            alert('제1운전자 면허번호를 올바르게 입력해주시기 바랍니다.');\r\n                            $('input[name=nums]').focus();\r\n                            return false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(!$agree && !$agreeCancel[0].checked) {\r\n\t\t\t\t\t$agree = $agreeCancel;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(!$agree && !$agreeTransaction[0].checked) {\r\n\t\t\t\t\t$agree = $agreeTransaction;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif($agree) {\r\n\t\t\t\t\talert($agree.data('title') + '에 동의하셔야합니다.');\r\n\t\t\t\t\t$agree.focus();\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\r\n                var action = $reservationForm.attr('action');\r\n                if($paymentAmount.data('current') <= 0) {\t//결제금액이 0원\r\n                    if(buyMethod == \"F\" && payType == \"2\"){ //장기(정기결제) 일경우\r\n\t\t\t\t\t\talert('쿠폰등의 할인을 통한 결제금액이 0원일 경우,\\n결제 방법은 \\\"전액결제\\\"로만 진행 가능합니다.');\r\n\t\t\t\t\t\treturn false;\r\n                    }else{\r\n\t\t\t\t\t\tif(!confirm('결제금액이 0원이므로, 결제정보 입력 절차 없이 바로 예약이 진행됩니다.\\n\\n예약을 진행하시겠습니까?')) {\r\n                            return false;\r\n                        }\r\n                        action = '/payment/allat_payment.php';\r\n\t\t\t\t\t}\r\n                }\r\n\t\t\t\tvar running = $form.data('running');\r\n\t\t\t\tif(!running) {\r\n\t\t\t\t\t// $form.data('running', true);\r\n\t\t\t\t\t// var buymethod = $('#buymethod').val();\r\n\r\n\t\t\t\t\t$.post(action, $reservationForm.serializeArray())\r\n\t\t\t\t\t\t.done(function(html){\r\n\t\t\t\t\t\t\t$paymentForm.html(html);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t$paymentAmount.trigger('calc');\r\n});"],"sourceRoot":"../../src/js"}