{"version":3,"sources":["rentking.w.search.js"],"names":["$","$searchWrap","$searchMap","$searchForm","find","$mapWrap","$listContentWrap","$listScrollInner","$listScrollContent","resizeContentWrap","headerHeight","outerHeight","height","window","innerHeight","css","addClass","searchMap","map","center","clearTimeout","timeout","setTimeout","panTo","on","document","e","param","stopPropagation","rentshop","rentshopMarker","i","length","setMap","bounds","daum","maps","LatLngBounds","searchMarker","pickupMarker","pickupReturnMarker","extend","getPosition","position","LatLng","lat","lng","addr1","split","content","slice","join","availcar","totalcar","marker","customOverlay","CustomOverlay","yAnchor","push","setBounds","$marker","this","$parent","parent","originalZIndex","data","zIndex","hasClass","preventDefault","removeClass","relayout","$page","searchWrapOffset","offset","each","$li","listItemOffset","$item","top","scrollTarget","scrollTop","trigger","go","idx","setLevel","getLevel","getCenter","submit","runLocationTask"],"mappings":"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","file":"rentking.w.search.min.js","sourcesContent":["/**\r\n  * Date: 2017-04-10\r\n */\r\n\r\n\r\n\r\n$(function() {\r\n\tvar $searchWrap = $('#searchWrap');\r\n\tvar $searchMap = $('#searchMap');\r\n\tvar $searchForm = $searchWrap.find('#searchForm');\r\n\tvar $mapWrap = $searchWrap.find('.map-wrap');\r\n\tvar $mapPointWrap = $mapWrap.find('.map-point-wrap');\r\n\tvar $listContentWrap = $('.list-content-wrap');\r\n\tvar $listScrollInner = $listContentWrap.find('.list-scroll-inner');\r\n\tvar $listScrollContent = $listScrollInner.find('.list-scroll-content');\r\n\r\n\tvar resizeContentWrap = function() {\r\n\t\tvar headerHeight = $('.header-wrap').outerHeight();\r\n\t\tvar height = window.innerHeight - headerHeight;\r\n\t\tif (height < 400)\r\n\t\t\theight = 400;\r\n\t\t$searchWrap.css({height: height});\r\n\t\t$('body').addClass('resized');\r\n\r\n\t\tif (searchMap.map && searchMap.center) {\r\n\t\t\tclearTimeout(searchMap.timeout);\r\n\t\t\tsearchMap.timeout = setTimeout(function () {\r\n\t\t\t\tsearchMap.map.panTo(searchMap.center);\r\n\t\t\t}, 300);\r\n\t\t}\r\n\t};\r\n\r\n\tresizeContentWrap();\r\n\t$(window).on('resize', function() {\r\n\t\tresizeContentWrap();\r\n\t});\r\n\r\n\t$(document)\r\n\t\t.on('setRentshopMarker', '#searchWrap', function(e, param) {\r\n\t\t\te.stopPropagation();\r\n\r\n\t\t\tvar rentshop = param.rentshop;\r\n\r\n\t\t\tif(searchMap.rentshopMarker) {\r\n\t\t\t\tfor(i = 0; i < searchMap.rentshopMarker.length; i++) {\r\n\t\t\t\t\tsearchMap.rentshopMarker[i].setMap(null);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tsearchMap.rentshopMarker = null;\r\n\t\t\tsearchMap.bounds = new daum.maps.LatLngBounds();\r\n\r\n\t\t\tif(searchMap.searchMarker || searchMap.pickupMarker || searchMap.pickupReturnMarker) {\r\n\t\t\t\tsearchMap.bounds.extend((searchMap.searchMarker || searchMap.pickupMarker || searchMap.pickupReturnMarker).getPosition());\r\n\t\t\t}\r\n\r\n\t\t\tif(rentshop.length > 0) {\r\n\t\t\t\tsearchMap.rentshopMarker = [];\r\n\t\t\t\tfor(var i = 0; i < rentshop.length; i++) {\r\n\t\t\t\t\tvar position = new daum.maps.LatLng(rentshop[i].lat, rentshop[i].lng);\r\n\t\t\t\t\tsearchMap.bounds.extend(position);\r\n\r\n\t\t\t\t\tvar addr1 = rentshop[i]['addr1'].split(' ');\r\n\t\t\t\t\tvar content = '<div class=\"info\">' +\r\n\t\t\t\t\t\t\t// '<div class=\"name\">' + rentshop[i]['name'] + '(' + rentshop[i]['affiliate']+ ')</div>' +\r\n\t\t\t\t\t\t\t// '<div class=\"address\">' + rentshop[i]['addr1'] + ' ' + rentshop[i]['addr2'] + '</div>' +\r\n\t\t\t\t\t\t\t'<div class=\"name\">' + rentshop[i]['affiliate'] + '</div>' +\r\n\t\t\t\t\t\t\t'<div class=\"address\">' + addr1.slice(0, addr1.length > 3 && (addr1[1] == '고양시' || addr1[1] == '성남시') ? 4 : 3).join(' ') + '</div>' +\r\n\t\t\t\t\t\t\t'<div class=\"time\">' +\r\n\t\t\t\t\t\t\t\t'<div class=\"title\">운영시간</div>' +\r\n\t\t\t\t\t\t\t\t'<div class=\"data\">평일(' + rentshop[i]['s1time1'] + ' ~ ' + rentshop[i]['s1time2'] + ')<br />주말/공휴일(' + rentshop[i]['s2time1'] + ' ~ ' + rentshop[i]['s2time2'] + ')</div>' +\r\n\t\t\t\t\t\t\t'</div>' +\r\n\t\t\t\t\t\t\t'<div class=\"cars\">' +\r\n\t\t\t\t\t\t\t\t'<div class=\"title\">운영차량 <span class=\"description\">(이용가능/전체차량)</span></div>' +\r\n\t\t\t\t\t\t\t\t'<div class=\"data\">' + rentshop[i].availcar + '대/' + rentshop[i].totalcar + '대</div>' +\r\n\t\t\t\t\t\t\t'</div>' +\r\n\t\t\t\t\t\t'</div>';\r\n\t\t\t\t\tvar marker = '<div class=\"marker rentshop-info\" id=\"rentshop' + rentshop[i]['idx'] + '\">' + content + '</div>';\r\n\t\t\t\t\tvar customOverlay = new daum.maps.CustomOverlay({\r\n\t\t\t\t\t\tposition: position,\r\n\t\t\t\t\t\tcontent: marker,\r\n\t\t\t\t\t\tyAnchor: 1\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tcustomOverlay['idx'] = rentshop[i]['idx'];\r\n\r\n\t\t\t\t\tcustomOverlay.setMap(searchMap.map);\r\n\t\t\t\t\tsearchMap.rentshopMarker.push(customOverlay);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tsearchMap.map.setBounds(searchMap.bounds);\r\n\t\t})\r\n\t\t.on('mouseenter', '#searchMap .marker.rentshop-info', function() {\r\n\t\t\tvar $marker = $(this);\r\n\t\t\tvar $parent = $marker.parent();\r\n\t\t\tvar originalZIndex = $parent.css('z-index');\r\n\t\t\t$parent.data('originalZIndex', originalZIndex);\r\n\r\n\t\t\tvar zIndex = 100;\r\n\t\t\tif($marker.hasClass('on'))\r\n\t\t\t\tzIndex = 50;\r\n\r\n\t\t\t$parent.css({zIndex: zIndex});\r\n\t\t})\r\n\t\t.on('mouseleave', '#searchMap .marker.rentshop-info', function() {\r\n\t\t\tvar $parent = $(this).parent();\r\n\t\t\tvar originalZIndex = $parent.data('originalZIndex');\r\n\t\t\t$parent.css({zIndex: originalZIndex});\r\n\t\t})\r\n\t\t.on('click', '.map-wrap .go-list', function(e) {\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\t$searchWrap.addClass('list').removeClass('re-search');\r\n\t\t\tif($searchWrap.data('detail')) {\r\n\t\t\t\t$searchWrap.data('detail', false);\r\n\t\t\t}\r\n\r\n\t\t\t$listScrollContent.find('li.item').removeClass('on');\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tsearchMap.map.relayout();\r\n\t\t\t\tsearchMap.map.panTo(searchMap.center);\r\n\t\t\t}, 400);\r\n\t\t})\r\n\t\t.on('init', '.list-content-wrap .list-scroll .page', function(e) {\r\n\t\t\te.stopPropagation();\r\n\r\n\t\t\tvar $page = $(this);\r\n\t\t\tvar searchWrapOffset = $searchWrap.offset();\r\n\t\t\t$page.find('li.item').each(function() {\r\n\t\t\t\tvar $li = $(this);\r\n\t\t\t\tvar offset = $li.offset();\r\n\r\n\t\t\t\twindow.listItemOffset.push({\r\n\t\t\t\t\t$item: $li,\r\n\t\t\t\t\toffset: offset.top - searchWrapOffset.top + scrollTarget.scrollTop()\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\t$page.addClass('init');\r\n\t\t\tscrollTarget.trigger('scroll');\r\n\t\t})\r\n\t\t.on('goRentshop', '.list-content-wrap .list-scroll .page li.item', function(e) {\r\n\t\t\te.stopPropagation();\r\n\r\n\t\t\tvar $item = $(this);\r\n\t\t\tvar rentshop = $item.data('rentshop');\r\n\r\n\t\t\tvar go = function() {\r\n\t\t\t\tif(!$searchMap.find('#rentshop' + rentshop).hasClass('on')) {\r\n\t\t\t\t\t$searchMap.find('.marker.rentshop-info').removeClass('on').trigger('mouseleave');\r\n\r\n\t\t\t\t\tfor(var i in searchMap.rentshopMarker) {\r\n\t\t\t\t\t\tif(searchMap.rentshopMarker[i].idx == rentshop) {\r\n\t\t\t\t\t\t\tvar bounds = new daum.maps.LatLngBounds();\r\n\t\t\t\t\t\t\tbounds.extend(searchMap.rentshopMarker[i].getPosition());\r\n\t\t\t\t\t\t\tif(searchMap.searchMarker || searchMap.pickupMarker || searchMap.pickupReturnMarker) {\r\n\t\t\t\t\t\t\t\tbounds.extend((searchMap.searchMarker || searchMap.pickupMarker || searchMap.pickupReturnMarker).getPosition());\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// bounds.extend(searchMap.searchMarker.getPosition());\r\n\t\t\t\t\t\t\tsearchMap.map.setBounds(bounds);\r\n\t\t\t\t\t\t\tsearchMap.map.setLevel(searchMap.map.getLevel()+1);\r\n\t\t\t\t\t\t\tsearchMap.center = searchMap.map.getCenter();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$searchMap.find('#rentshop' + rentshop).addClass('on').trigger('mouseenter');\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tvar back = function() {\r\n\t\t\t\tif($searchMap.find('#rentshop' + rentshop).hasClass('on')) {\r\n\t\t\t\t\t$searchMap.find('.marker.rentshop-info').removeClass('on').trigger('mouseleave');\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tif($item.hasClass('on')) {\r\n\t\t\t\tif(!$searchWrap.hasClass('detail') || $searchWrap.hasClass('filter')) {\r\n\t\t\t\t\t$searchWrap.addClass('detail').data('detail', true);\r\n\t\t\t\t\tclearTimeout(searchMap.timeout);\r\n\t\t\t\t\tsearchMap.timeout = setTimeout(function() {\r\n\t\t\t\t\t\tsearchMap.map.relayout();\r\n\t\t\t\t\t\tgo();\r\n\t\t\t\t\t}, 300);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tgo();\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tback();\r\n\t\t\t}\r\n\r\n\t\t})\r\n\t\t.on('click', '.list-search-wrap button.option, .list-content-wrap .grade-info button.option', function() {\r\n\t\t\t$searchForm.trigger('resetList').submit();\r\n\t\t})\r\n\t\t.on('click', '.list-search-wrap input[name=\"nosmoke\"]', function() {\r\n\t\t\t$searchForm.trigger('resetList').submit();\r\n\t\t})\r\n\r\n\t;\r\n\r\n\trunLocationTask();\r\n});"],"sourceRoot":"../../src/js"}